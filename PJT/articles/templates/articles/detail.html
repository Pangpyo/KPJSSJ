{% extends 'base.html' %}
{% load static %}
{% load django_bootstrap5 %}
{% block css %}{% endblock css %}

{% block content %}

<div class="container d-flex flex-column justify-content-center my-5">
  <div class="review-detail p-5 rounded-4 shadow-lg">
    <h1 class="text-white font-space">{{ review.title }}</h1>
    <i></i>
    <hr>
    <div class="d-flex justify-content-between align-middle">
      <p class="text-white">작성자 : {{ review.user }}</p>
      {% if review.created_at == review.updated_at %}
      <p class="text-white">{{ review.created_at }}</p>
      {% else %}
      <p class="text-white">{{ review.updated_at }} (수정됨)</p>
      {% endif %}
    </div>
    <hr class="mt-0">
    <pre class="fs-6 text-white ">{{ review.content}}</pre>
    <div class="d-flex justify-content-end my-3">
      {% if request.user == review.user %}
      <a href="{% url 'articles:update' review.pk %}" class="btn btn-dark">글 수정</a>
      {% endif %}
    </div>
    <form action="{% url 'articles:comment_create' review.pk %}" method="POST">
      {% csrf_token %}
      {% bootstrap_form comment_form %}
      <div class="text-end"><input class="btn btn-success" type="submit" value="댓글 작성"></div>
    </form>
    <h4 class="text-white">댓글 ({{ comments|length }})</h4>
    <hr>
    <ul class="list-group list-group-flush rounded-2">
      {% for comment in comments %}
      <li class="list-group-item align-middle">
        <div class="d-flex justify-content-between align-items-center">
          <p class="card-text mx-2 my-2">{{ comment.user }}</p>

          <div class="d-flex">
            <p class="card-text text-black">{{ comment.created_at }}</p>
            {% if request.user == comment.user %}
            <form action="{% url 'articles:comment_delete' review.pk comment.pk %}" method="POST">
              {% csrf_token %}
              <input class="bg-danger text-white mx-2 border-0 text-decoration-none rounded-2" type="submit" value="삭제">
            </form>
            {% endif %}
          </div>

        </div>
        <div class="m-2">
          {{ comment.content }}
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock content %}